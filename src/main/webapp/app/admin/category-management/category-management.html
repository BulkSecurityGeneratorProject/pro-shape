<div class="container">

    <h1 class="mt-4 mb-3">Category Management</h1>
    <!-- Page Heading/Breadcrumbs -->
    <ol class="breadcrumb">
        <li class="breadcrumb-item">
            <a ui-sref="home">Home</a>
        </li>
        <li class="breadcrumb-item">
            <a ui-sref="admin">Admin</a>
        </li>
        <li class="breadcrumb-item active">Category Management</li>
    </ol>

    <!-- Blog Post -->
    <div class="card mb-4">

        <!-- Creation succes! -->
        <div class="card-block" ng-show="cmCtrl.success">
            <div class="row">
                <div class="col-md-6" style="float: none; margin: 0 auto;">
                    <div class="alert alert-success">
                        <strong class="text-center">{{cmCtrl.success}}</strong>
                    </div>
                </div>
            </div>
        </div>

        <div class="card-block" ng-show="!cmCtrl.success">
            <div class="row">
                <div style="margin: 0 auto;">
                    <h2 class="text-center">Categories</h2>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <h4>Models</h4>

                    <button type="button" class="btn btn-primary btn-sm"
                            data-toggle="modal" data-target="#createCategoryModal" ng-click="cmCtrl.setNewCategoryType('model')">
                        Create new
                    </button>
                    <hr>

                    <div class="breadcrumb" ng-repeat="catM in cmCtrl.modelCategories">
                        <div class="breadcrumb-item">
                            <a href="/#/cat_obj/{{catM.id}}"><b>{{catM.name}}</b></a> ({{catM.models.length}})
                        </div>
                        <div class="breadcrumb-item">
                            <button type="button" class="btn btn-primary btn-sm"
                                    data-toggle="modal" data-target="#editCategoryModal" ng-click="cmCtrl.setEditedCategory(catM)">
                                Edit
                            </button>
                        </div>
                        <div class="breadcrumb-item">
                            <button type="button" class="btn btn-primary btn-sm"
                                    data-toggle="modal" data-target="#deleteCategoryModal" ng-click="cmCtrl.setDeletedCategory(catM)">
                                Delete
                            </button>
                        </div>
                    </div>

                </div>
                <div class="col-md-6">
                    <h4>Exhibitions</h4>
                    <button type="button" class="btn btn-primary btn-sm"
                                                 data-toggle="modal" data-target="#createCategoryModal" ng-click="cmCtrl.setNewCategoryType('exhib')">
                    Create new
                </button>

                    <hr>

                    <div class="breadcrumb" ng-repeat="catE in cmCtrl.exhibCategories">
                        <div class="breadcrumb-item">
                            <a href="/#/cat_obj/{{catE.id}}"><b>{{catE.name}}</b></a> ({{catE.exhibs.length()}})
                        </div>
                        <div class="breadcrumb-item">
                            <button type="button" class="btn btn-primary btn-sm"
                                    data-toggle="modal" data-target="#editCategoryModal" ng-click="cmCtrl.setEditedCategory(catE)">
                                Edit
                            </button>
                        </div>
                        <div class="breadcrumb-item">
                            <button type="button" class="btn btn-primary btn-sm"
                                    data-toggle="modal" data-target="#deleteCategoryModal" ng-click="cmCtrl.setDeletedCategory(catE)">
                                Delete
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- createCategory Modal -->
<div class="modal fade" id="createCategoryModal" tabindex="-1" role="dialog" aria-labelledby="createCategoryModal"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Create category</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="control-label" for="name">Category name</label>
                    <input type="text" class="form-control" id="name" name="name" placeholder="Category name..."
                           ng-model="cmCtrl.newCategory.name" ng-minlength=3 ng-maxlength=50 required>
                </div>
                <div class="form-group">
                    <label class="control-label" for="description">Description</label>
                    <textarea rows="10" cols="51" ng-model="cmCtrl.newCategory.description" id="description" name="description" maxlength=200></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="cmCtrl.createCategory()" >Create</button>
            </div>
        </div>
    </div>
</div>

<!-- editCategory Modal -->
<div class="modal fade" id="editCategoryModal" tabindex="-1" role="dialog" aria-labelledby="editCategoryModal"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Edit category</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="control-label" for="changeName">Category name</label>
                    <input type="text" class="form-control" id="changeName" name="changeName" placeholder="Category name..."
                           ng-model="cmCtrl.editCategory.name" ng-minlength=3 ng-maxlength=50 required>
                </div>
                <div class="form-group">
                    <label class="control-label" for="changeType">Category type: </label>
                    <p id="changeType">{{cmCtrl.editCategory.type}}</p>
                </div>
                <div class="form-group">
                    <label class="control-label" for="changeDescription">Description</label>
                    <textarea rows="10" cols="51" ng-model="cmCtrl.editCategory.description" id="changeDescription" name="changeDescription" maxlength=200></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="cmCtrl.updateCategoryNames()" >Save</button>
            </div>
        </div>
    </div>
</div>

<!-- deleteCategory Modal -->
<div class="modal fade" id="deleteCategoryModal" tabindex="-1" role="dialog" aria-labelledby="deleteCategoryModal"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Delete category</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <strong>Do you want to delete category {{cmCtrl.delCategory.name}}?</strong>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="cmCtrl.deleteCategory()" >Delete</button>
            </div>
        </div>
    </div>
</div>
